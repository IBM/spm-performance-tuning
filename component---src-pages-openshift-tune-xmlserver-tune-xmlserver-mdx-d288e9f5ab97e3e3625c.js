"use strict";(self.webpackChunkcuram_performance_tuning=self.webpackChunkcuram_performance_tuning||[]).push([[189],{7581:function(e,n,a){a.r(n),a.d(n,{_frontmatter:function(){return s},default:function(){return h}});var r=a(45),t=(a(6540),a(5680)),i=a(4330);const o=["components"],s={},l=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,t.yg)("div",n)},p=l("AnchorLinks"),m=l("AnchorLink"),u=l("InlineNotification"),g={_frontmatter:s},d=i.A;function h(e){let{components:n}=e,a=(0,r.A)(e,o);return(0,t.yg)(d,Object.assign({},g,a,{components:n,mdxType:"MDXLayout"}),(0,t.yg)(p,{small:!0,mdxType:"AnchorLinks"},(0,t.yg)(m,{mdxType:"AnchorLink"},"Overview"),(0,t.yg)(m,{mdxType:"AnchorLink"},"Replicas"),(0,t.yg)(m,{mdxType:"AnchorLink"},"Pod requests and limits"),(0,t.yg)(m,{mdxType:"AnchorLink"},"Tuning the XML server running in a pod"),(0,t.yg)(m,{mdxType:"AnchorLink"},"Assessing XML server performance")),(0,t.yg)("h2",null,"Overview"),(0,t.yg)("p",null,"The following information is specific for the tuning of the Cúram XML server on OpenShift and Kubernetes Services."),(0,t.yg)("p",null,"Additionally, the general XML server tuning information is available in the ",(0,t.yg)("a",{parentName:"p",href:"/curam-performance-tuning/common_task/xmlservertuning"},"Tuning the XML server")," section of this guide."),(0,t.yg)("h2",null,"Pod replica count"),(0,t.yg)("p",null,"The number of XML Server replicas in a deployment can be specified globally via ",(0,t.yg)("inlineCode",{parentName:"p"},"xmlserver.replicaCount"),", which can be used to amend the default single instance."),(0,t.yg)("h2",null,"Pod requests and limits"),(0,t.yg)("p",null,"When assessing XML server performance and the setting of XML server pod requests and limits, note that additional replicas are automatically load balanced via the ",(0,t.yg)("inlineCode",{parentName:"p"},"release-xmlserver")," service."),(0,t.yg)("p",null,"The XML server pod ",(0,t.yg)("inlineCode",{parentName:"p"},"cpu")," and ",(0,t.yg)("inlineCode",{parentName:"p"},"memory")," resource requests and limits can be specified by setting ",(0,t.yg)("inlineCode",{parentName:"p"},"cpu"),": and ",(0,t.yg)("inlineCode",{parentName:"p"},"memory"),": values for the ",(0,t.yg)("inlineCode",{parentName:"p"},"xmlserver.resources")," keys."),(0,t.yg)("p",null,"The following example illustrates how to set the number of replicas to ",(0,t.yg)("inlineCode",{parentName:"p"},"6"),", with resources requests for the ",(0,t.yg)("inlineCode",{parentName:"p"},"cpu")," of 1 and a ",(0,t.yg)("inlineCode",{parentName:"p"},"memory")," of 1024Mi, and with resources limits for the ",(0,t.yg)("inlineCode",{parentName:"p"},"cpu")," of 1 and a ",(0,t.yg)("inlineCode",{parentName:"p"},"memory")," of 1024Mi:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-yaml"},"xmlserver:\n  replicaCount: 6\n  resources:\n    requests:\n      cpu: 1\n      memory: 1024Mi\n    limits:\n      cpu: 1\n      memory: 1024Mi\n")),(0,t.yg)(u,{kind:"warning",mdxType:"InlineNotification"},(0,t.yg)("p",null,"For the Guaranteed QoS, Cúram highly recommends that a pod must have ",(0,t.yg)("strong",{parentName:"p"},"both")," CPU and Memory requests and limits set to equal values. If requests & limits are different for a given pod, it would be eligible for rescheduling in case of resource pressure on its node."),(0,t.yg)("p",null,"For more information please review ",(0,t.yg)("a",{parentName:"p",href:"https://kubernetes.io/docs/tasks/configure-pod-container/quality-service-pod/#create-a-pod-that-gets-assigned-a-qos-class-of-guaranteed"},"Configure Quality of Service for Pods"),".")),(0,t.yg)("h2",null,"Tuning the XML server running in a pod"),(0,t.yg)("p",null,"The XML server provides two areas for tuning:"),(0,t.yg)("ol",null,(0,t.yg)("li",{parentName:"ol"},"The XML server configuration"),(0,t.yg)("li",{parentName:"ol"},"The JVM in which the XML server runs")),(0,t.yg)("p",null,"Specific settings for each of these areas are available via Helm Chart overrides.  For more information about Helm Charts see the Cúram on Kubernetes Runbook:"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},"The ",(0,t.yg)("a",{parentName:"li",href:"https://merative.github.io/spm-kubernetes/deployment/config-reference/#xml-server"},"Configuration Reference")," section lists the Helm Chart settings and their default values for the configuration that follows;"),(0,t.yg)("li",{parentName:"ul"},"The ",(0,t.yg)("a",{parentName:"li",href:"https://merative.github.io/spm-kubernetes/deployment/hc_deployment/"},"Deploying Helm Charts")," section describes how to specify Helm Chart overrides in an override file.")),(0,t.yg)("h3",null,"XML server configuration"),(0,t.yg)("p",null,"These are configuration settings of the XML server, accessible via Helm Chart overrides, that can be used to tune its performance:"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},"XML server thread pool size - This setting essentially controls the amount of work the XML server can do."),(0,t.yg)("li",{parentName:"ul"},"XML server thread pool queue size - This setting controls the number of requests that are queued inside the XML server as opposed to the TCP backlog queue."),(0,t.yg)("li",{parentName:"ul"},"XML server socket timeout - This setting (expressed as milliseconds) determines the length of time the XML server will wait for a socket request to complete.")),(0,t.yg)("p",null,"The Cúram Helm Charts are coded to be able to specify ",(0,t.yg)("inlineCode",{parentName:"p"},"threadPoolSize"),", ",(0,t.yg)("inlineCode",{parentName:"p"},"threadPoolQueueSize")," and ",(0,t.yg)("inlineCode",{parentName:"p"},"socketTimeout"),". For instance, this shows the default settings for ",(0,t.yg)("inlineCode",{parentName:"p"},"xmlserver")," application pods:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-yaml"},"xmlserver:\n  config:\n    threadPoolSize: 5\n    threadPoolQueueSize: 200\n    socketTimeout: 60000\n")),(0,t.yg)("h3",null,"XML server JVM"),(0,t.yg)("p",null,"These are Java JVM settings, accessbile via Helm Chart overrides, that can be used to tune its performance:"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},"Java maximum heap - This setting maps to the the ",(0,t.yg)("inlineCode",{parentName:"li"},"maxmemory")," attribute of the Ant ",(0,t.yg)("inlineCode",{parentName:"li"},"<java>")," task in the XML server ",(0,t.yg)("inlineCode",{parentName:"li"},"xmlserver.xml")," Ant script, which is invoked when the pod is started. (Note: Ant’s ",(0,t.yg)("inlineCode",{parentName:"li"},"maxmemory")," attribute overrides the JVM ",(0,t.yg)("inlineCode",{parentName:"li"},"-Xmx")," setting.)"),(0,t.yg)("li",{parentName:"ul"},"Java thread stack size - This maps to  the specification of the JVM stack size argument, ",(0,t.yg)("inlineCode",{parentName:"li"},"-Xss"),", specified as an Ant property override; for example: ",(0,t.yg)("inlineCode",{parentName:"li"},'-Djava.thread.stack.size="-Xss4m"'))),(0,t.yg)("p",null,"The Cúram Helm Charts are coded to be able to specify the JVM ",(0,t.yg)("inlineCode",{parentName:"p"},"maxMemory")," and ",(0,t.yg)("inlineCode",{parentName:"p"},"threadStackSize"),". For instance, this shows the default settings for ",(0,t.yg)("inlineCode",{parentName:"p"},"xmlserver")," application pods:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-yaml"},"xmlserver:\n  jvm:\n    maxMemory: '-Djava.maxmemory=768m'\n    threadStackSize: '-Djava.thread.stack.size=-Xss4m'\n")),(0,t.yg)("h2",null,"Assessing XML server performance"),(0,t.yg)("p",null,"The following data can help you assess when tuning may be called for (note limited data availability when not using persistence):"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},"JVM verbose garbage collection data is your primary source of information on whether the Java heap is sized appropriately.",(0,t.yg)("ul",{parentName:"li"},(0,t.yg)("li",{parentName:"ul"},"Availability of data:",(0,t.yg)("ul",{parentName:"li"},(0,t.yg)("li",{parentName:"ul"},"When persistence is configured ",(0,t.yg)("inlineCode",{parentName:"li"},"verbosegc.log")," can be found in the persistent ",(0,t.yg)("inlineCode",{parentName:"li"},"gc")," folder of the XML server pod."),(0,t.yg)("li",{parentName:"ul"},"When persistence is not configured ",(0,t.yg)("inlineCode",{parentName:"li"},"verbosegc.log")," can be found in the ",(0,t.yg)("inlineCode",{parentName:"li"},"/opt/ibm/Curam/xmlserver/tmp")," folder of the XML server pod during its execution."))),(0,t.yg)("li",{parentName:"ul"},"To process the data you can use the\n",(0,t.yg)("a",{parentName:"li",href:"https://www.ibm.com/support/pages/garbage-collection-and-memory-visualizer-gcmv-2701-ibm-support-assistant-team-server"},"IBM Garbage Collection and Memory Visualizer (GCMV)")," tool."))),(0,t.yg)("li",{parentName:"ul"},"XML server thread pool worker data is your primary source of information on how the XML server is performing, which can be impacted by, among other factors, how the JVM is performing.",(0,t.yg)("ul",{parentName:"li"},(0,t.yg)("li",{parentName:"ul"},"Availability of data:",(0,t.yg)("ul",{parentName:"li"},(0,t.yg)("li",{parentName:"ul"},"When persistence is configured the ",(0,t.yg)("inlineCode",{parentName:"li"},"ThreadPoolWorker-*")," files can be found in the persistent ",(0,t.yg)("inlineCode",{parentName:"li"},"stats")," folder of the XML server pod after it has been stopped."),(0,t.yg)("li",{parentName:"ul"},"When persistence is not configured there is no data available."))),(0,t.yg)("li",{parentName:"ul"},"To process the data you can use text-based tools such as ",(0,t.yg)("a",{parentName:"li",href:"https://en.wikipedia.org/wiki/AWK"},"awk")," as the data in the ",(0,t.yg)("inlineCode",{parentName:"li"},"ThreadPoolWorker-*")," files\nis tab-delimited, one file per thread (as specified by ",(0,t.yg)("a",{parentName:"li",href:"/curam-performance-tuning/common_task/xmlservertuning#tuning-and-configuration-changes"},"<THREAD_POOL_SIZE>"),").")))))}h.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-openshift-tune-xmlserver-tune-xmlserver-mdx-d288e9f5ab97e3e3625c.js.map